{
  "metadata": {
    "description": "Comprehensive model comparison queries for BGE-M3 vs Qodo-1.5B",
    "total_queries": 30,
    "categories": ["code_specific", "architecture", "error_handling", "cross_language", "graph_aware", "performance"],
    "created": "2025-11-09",
    "purpose": "Test code-specific model (Qodo) vs general-purpose model (BGE-M3) with focus on graph metadata"
  },
  "queries": [
    {
      "id": 1,
      "category": "code_specific",
      "query": "function that generates embeddings in batches",
      "description": "Tests code intent understanding and batch processing patterns",
      "expected_top_files": [
        "embeddings/embedder.py"
      ],
      "expected_functions": [
        "embed_chunks",
        "embed_chunk"
      ],
      "graph_validation": null,
      "difficulty": "medium"
    },
    {
      "id": 2,
      "category": "code_specific",
      "query": "BM25 tokenization with stopword filtering",
      "description": "Tests technical term matching and preprocessing logic",
      "expected_top_files": [
        "search/bm25_index.py"
      ],
      "expected_functions": [
        "TextPreprocessor",
        "preprocess_code"
      ],
      "graph_validation": null,
      "difficulty": "medium"
    },
    {
      "id": 3,
      "category": "code_specific",
      "query": "FAISS index initialization and GPU management",
      "description": "Tests library-specific code patterns",
      "expected_top_files": [
        "search/indexer.py",
        "search/hybrid_searcher.py"
      ],
      "expected_functions": [
        "CodeIndexManager",
        "__init__",
        "add_embeddings"
      ],
      "graph_validation": null,
      "difficulty": "hard"
    },
    {
      "id": 4,
      "category": "code_specific",
      "query": "tree-sitter AST parsing for multiple languages",
      "description": "Tests multi-language code understanding",
      "expected_top_files": [
        "chunking/tree_sitter.py",
        "chunking/multi_language_chunker.py"
      ],
      "expected_functions": [
        "TreeSitterChunker",
        "chunk_file",
        "_parse_tree_sitter"
      ],
      "graph_validation": null,
      "difficulty": "hard"
    },
    {
      "id": 5,
      "category": "code_specific",
      "query": "call graph extraction using Python AST visitor",
      "description": "Tests graph algorithm + AST pattern recognition",
      "expected_top_files": [
        "graph/call_graph_extractor.py"
      ],
      "expected_functions": [
        "PythonCallGraphExtractor",
        "extract_calls",
        "_extract_call_from_node"
      ],
      "graph_validation": {
        "expect_graph_metadata": true,
        "expect_calls": true
      },
      "difficulty": "hard"
    },
    {
      "id": 6,
      "category": "code_specific",
      "query": "Merkle tree change detection for incremental indexing",
      "description": "Tests algorithm + file system interaction patterns",
      "expected_top_files": [
        "merkle/merkle_dag.py",
        "search/incremental_indexer.py"
      ],
      "expected_functions": [
        "MerkleDAG",
        "detect_changes",
        "build_tree"
      ],
      "graph_validation": null,
      "difficulty": "hard"
    },
    {
      "id": 7,
      "category": "code_specific",
      "query": "hybrid search RRF reranking algorithm",
      "description": "Tests algorithm implementation understanding",
      "expected_top_files": [
        "search/reranker.py",
        "search/hybrid_searcher.py"
      ],
      "expected_functions": [
        "rerank_simple",
        "rerank_with_rrf",
        "search"
      ],
      "graph_validation": {
        "expect_graph_metadata": true,
        "expect_calls": ["rerank_simple", "rerank_with_rrf"]
      },
      "difficulty": "medium"
    },
    {
      "id": 8,
      "category": "code_specific",
      "query": "model cache validation with incomplete download cleanup",
      "description": "Tests complex error handling + file operations",
      "expected_top_files": [
        "embeddings/embedder.py"
      ],
      "expected_functions": [
        "_validate_model_cache",
        "_check_incomplete_downloads",
        "_cleanup_incomplete_downloads"
      ],
      "graph_validation": {
        "expect_graph_metadata": true,
        "expect_calls": true
      },
      "difficulty": "hard"
    },
    {
      "id": 9,
      "category": "architecture",
      "query": "how does multi-hop search discover related code",
      "description": "Tests natural language â†’ architectural understanding",
      "expected_top_files": [
        "search/hybrid_searcher.py"
      ],
      "expected_functions": [
        "_multi_hop_search_internal",
        "_rerank_by_query"
      ],
      "graph_validation": {
        "expect_graph_metadata": true,
        "expect_calls": ["_rerank_by_query", "find_similar_to_chunk"]
      },
      "difficulty": "hard"
    },
    {
      "id": 10,
      "category": "architecture",
      "query": "MCP server tool implementation pattern",
      "description": "Tests framework pattern recognition",
      "expected_top_files": [
        "mcp_server/server.py"
      ],
      "expected_functions": [
        "search_code",
        "index_directory",
        "get_search_config_status"
      ],
      "graph_validation": null,
      "difficulty": "medium"
    },
    {
      "id": 11,
      "category": "architecture",
      "query": "configuration management and persistence",
      "description": "Tests system design pattern understanding",
      "expected_top_files": [
        "search/config.py"
      ],
      "expected_functions": [
        "SearchConfigManager",
        "get_search_config",
        "save_config"
      ],
      "graph_validation": {
        "expect_graph_metadata": true,
        "expect_calls": true
      },
      "difficulty": "medium"
    },
    {
      "id": 12,
      "category": "architecture",
      "query": "incremental indexing workflow with Merkle snapshots",
      "description": "Tests multi-component workflow understanding",
      "expected_top_files": [
        "search/incremental_indexer.py",
        "merkle/merkle_dag.py",
        "merkle/snapshot_manager.py"
      ],
      "expected_functions": [
        "IncrementalIndexer",
        "incremental_index",
        "MerkleDAG",
        "SnapshotManager"
      ],
      "graph_validation": {
        "expect_graph_metadata": true,
        "expect_calls": ["MerkleDAG", "SnapshotManager", "detect_changes"]
      },
      "difficulty": "hard"
    },
    {
      "id": 13,
      "category": "architecture",
      "query": "storage directory per-model dimension isolation",
      "description": "Tests resource management architecture",
      "expected_top_files": [
        "mcp_server/server.py",
        "search/config.py"
      ],
      "expected_functions": [
        "get_project_storage_dir",
        "get_storage_dir"
      ],
      "graph_validation": null,
      "difficulty": "medium"
    },
    {
      "id": 14,
      "category": "architecture",
      "query": "embedding batch size optimization by model type",
      "description": "Tests performance optimization patterns",
      "expected_top_files": [
        "search/config.py",
        "embeddings/embedder.py"
      ],
      "expected_functions": [
        "MODEL_REGISTRY",
        "embed_chunks",
        "recommended_batch_size"
      ],
      "graph_validation": null,
      "difficulty": "medium"
    },
    {
      "id": 15,
      "category": "error_handling",
      "query": "corrupted model cache recovery and fallback",
      "description": "Tests complex error recovery flows",
      "expected_top_files": [
        "embeddings/embedder.py"
      ],
      "expected_functions": [
        "_load_model",
        "_validate_model_cache",
        "_check_incomplete_downloads"
      ],
      "graph_validation": {
        "expect_graph_metadata": true,
        "expect_calls": ["_validate_model_cache", "_cleanup_incomplete_downloads"]
      },
      "difficulty": "hard"
    },
    {
      "id": 16,
      "category": "error_handling",
      "query": "BM25 index version mismatch detection",
      "description": "Tests version compatibility logic",
      "expected_top_files": [
        "search/bm25_index.py"
      ],
      "expected_functions": [
        "load",
        "INDEX_VERSION",
        "_check_version_compatibility"
      ],
      "graph_validation": null,
      "difficulty": "medium"
    },
    {
      "id": 17,
      "category": "error_handling",
      "query": "GPU memory exhaustion handling",
      "description": "Tests resource constraint handling",
      "expected_top_files": [
        "search/hybrid_searcher.py",
        "embeddings/embedder.py"
      ],
      "expected_functions": [
        "GPUMemoryMonitor",
        "cleanup",
        "_clear_gpu_cache"
      ],
      "graph_validation": null,
      "difficulty": "medium"
    },
    {
      "id": 18,
      "category": "error_handling",
      "query": "file removal with FAISS index rebuild",
      "description": "Tests data structure consistency maintenance",
      "expected_top_files": [
        "search/indexer.py",
        "search/hybrid_searcher.py"
      ],
      "expected_functions": [
        "remove_multiple_files",
        "_rebuild_faiss_index"
      ],
      "graph_validation": null,
      "difficulty": "hard"
    },
    {
      "id": 19,
      "category": "error_handling",
      "query": "empty query validation and graceful return",
      "description": "Tests input validation patterns",
      "expected_top_files": [
        "search/hybrid_searcher.py",
        "mcp_server/server.py"
      ],
      "expected_functions": [
        "search",
        "search_code"
      ],
      "graph_validation": null,
      "difficulty": "easy"
    },
    {
      "id": 20,
      "category": "cross_language",
      "query": "JavaScript function chunking with arrow functions",
      "description": "Tests language-specific syntax understanding",
      "expected_top_files": [
        "chunking/tree_sitter.py",
        "chunking/multi_language_chunker.py"
      ],
      "expected_functions": [
        "chunk_file",
        "_parse_tree_sitter",
        "SUPPORTED_EXTENSIONS"
      ],
      "graph_validation": null,
      "difficulty": "medium"
    },
    {
      "id": 21,
      "category": "cross_language",
      "query": "GLSL shader parsing for fragment and vertex shaders",
      "description": "Tests domain-specific language support",
      "expected_top_files": [
        "chunking/multi_language_chunker.py",
        "chunking/tree_sitter.py"
      ],
      "expected_functions": [
        "SUPPORTED_EXTENSIONS",
        "chunk_file"
      ],
      "graph_validation": null,
      "difficulty": "medium"
    },
    {
      "id": 22,
      "category": "cross_language",
      "query": "camelCase and snake_case identifier splitting",
      "description": "Tests code normalization across languages",
      "expected_top_files": [
        "search/bm25_index.py"
      ],
      "expected_functions": [
        "TextPreprocessor",
        "preprocess_code",
        "_split_identifiers"
      ],
      "graph_validation": null,
      "difficulty": "medium"
    },
    {
      "id": 23,
      "category": "cross_language",
      "query": "tree-sitter node type mapping to chunk types",
      "description": "Tests multi-language type system understanding",
      "expected_top_files": [
        "chunking/multi_language_chunker.py",
        "chunking/tree_sitter.py"
      ],
      "expected_functions": [
        "_convert_tree_chunks",
        "_get_chunk_type"
      ],
      "graph_validation": null,
      "difficulty": "hard"
    },
    {
      "id": 24,
      "category": "graph_aware",
      "query": "functions that call search_code in MCP server",
      "description": "Tests caller relationship discovery",
      "expected_top_files": [
        "mcp_server/server.py"
      ],
      "expected_functions": [
        "search_code"
      ],
      "graph_validation": {
        "expect_graph_metadata": true,
        "expect_called_by": true,
        "validate_callers": true
      },
      "difficulty": "hard"
    },
    {
      "id": 25,
      "category": "graph_aware",
      "query": "functions called by HybridSearcher.search method",
      "description": "Tests callee relationship accuracy",
      "expected_top_files": [
        "search/hybrid_searcher.py"
      ],
      "expected_functions": [
        "search",
        "_search_bm25",
        "_search_dense"
      ],
      "graph_validation": {
        "expect_graph_metadata": true,
        "expect_calls": ["_search_bm25", "_search_dense", "rerank_simple"],
        "validate_callees": true
      },
      "difficulty": "hard"
    },
    {
      "id": 26,
      "category": "graph_aware",
      "query": "MCP tool decorators and their implementations",
      "description": "Tests decorator pattern + implementation linkage",
      "expected_top_files": [
        "mcp_server/server.py"
      ],
      "expected_functions": [
        "search_code",
        "index_directory",
        "get_index_status"
      ],
      "graph_validation": null,
      "difficulty": "medium"
    },
    {
      "id": 27,
      "category": "graph_aware",
      "query": "network graph of incremental indexing components",
      "description": "Tests system-level dependency understanding",
      "expected_top_files": [
        "search/incremental_indexer.py",
        "merkle/merkle_dag.py",
        "merkle/snapshot_manager.py",
        "search/hybrid_searcher.py"
      ],
      "expected_functions": [
        "IncrementalIndexer",
        "MerkleDAG",
        "SnapshotManager",
        "HybridSearcher"
      ],
      "graph_validation": {
        "expect_graph_metadata": true,
        "expect_rich_connectivity": true,
        "min_calls_or_called_by": 3
      },
      "difficulty": "hard"
    },
    {
      "id": 28,
      "category": "performance",
      "query": "parallel search execution with ThreadPoolExecutor",
      "description": "Tests concurrency pattern recognition",
      "expected_top_files": [
        "search/hybrid_searcher.py"
      ],
      "expected_functions": [
        "_parallel_search",
        "search"
      ],
      "graph_validation": null,
      "difficulty": "medium"
    },
    {
      "id": 29,
      "category": "performance",
      "query": "batch removal optimization single-pass algorithm",
      "description": "Tests algorithmic optimization understanding",
      "expected_top_files": [
        "search/indexer.py",
        "search/bm25_index.py",
        "search/hybrid_searcher.py"
      ],
      "expected_functions": [
        "remove_multiple_files",
        "_batch_remove_chunks"
      ],
      "graph_validation": null,
      "difficulty": "hard"
    },
    {
      "id": 30,
      "category": "performance",
      "query": "embedding generation with configurable batch sizes",
      "description": "Tests performance tuning patterns",
      "expected_top_files": [
        "embeddings/embedder.py",
        "search/config.py"
      ],
      "expected_functions": [
        "embed_chunks",
        "MODEL_REGISTRY",
        "recommended_batch_size"
      ],
      "graph_validation": null,
      "difficulty": "medium"
    }
  ]
}
